<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Reporters sans frontières</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">

		<link rel="stylesheet/less" type="text/css" href="knacss/knacss.less" />

		<!-- GOOGLE ANALYTICS -->
		<script type="text/javascript">

		  var _gaq = _gaq || [];
		  _gaq.push(['_setAccount', 'UA-2498778-1']);
		  _gaq.push(['_setDomainName', 'rsf.org']);
		  _gaq.push(['_trackPageview']);

		  (function() {
		    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		  })();

		</script>

	</head>




	<body class="mode2d">
		
		<br/>
		
		<section id="cp" class="line center grid">
			<header class="mod grid4-1">
				<h1 class="mod">
					<a href="http://rsf.org">
						<img class="w150p" src="http://fr.rsf.org/squelettes/img/fr/logo-fr.png" alt="logo RSF"/>
					</a>
				</h1>

				<div class="grid">
					<ul class="grid2">
						<li class="mod">Français</li>
						<li class="mod">English</li>
					</ul>
				</div>
			</header>

			

			<article>

				<br/>
				<h2>Classement de la liberté de la presse</h2>
				<br/>
				<br/>

				<nav class="grid">
					<ul class="grid5">
						<li class="mod left"><a href="#">Asie</a></li>
						<li class="mod left"><a href="#">Afrique</a></li>
						<li class="mod left"><a href="#">Amériques</a></li>
						<li class="mod left"><a href="#">Moyen-orient et Maghreb</a></li>
						<li class="mod left"><a href="#">Europe et ex-URSS</a></li>
					</ul>
				</nav>


				<br/>
				<br/>
				<p id="intro">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec ultrices nisl nunc, quis mattis quam iaculis quis. Cras a mollis metus. Aliquam nulla massa, hendrerit et facilisis eu, convallis non dui. Nulla orci tellus, auctor vel mauris et, iaculis lacinia tellus. Nunc felis sem, pellentesque vel risus ac, accumsan consequat dolor. Donec a orci a tortor ultrices pellentesque. Suspendisse dignissim nulla ultricies enim feugiat lacinia sit amet ut nulla. </p>
				<p id="more">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec ultrices nisl nunc, quis mattis quam iaculis quis. Cras a mollis metus. Aliquam nulla massa, hendrerit et facilisis eu, convallis non dui. Nulla orci tellus, auctor vel mauris et, iaculis lacinia tellus. Nunc felis sem, pellentesque vel risus ac, accumsan consequat dolor. Donec a orci a tortor ultrices pellentesque. Suspendisse dignissim nulla ultricies enim feugiat lacinia sit amet ut nulla. </p>
			<article>


		</section>


		<section id="main">
		
				<article id="noWebgl"><p>Votre carte graphique ou votre navigateur ne supporte pas webgl. <br/>Vous pouvez essayer d'utiliser firefox ou rester sur la version 2d de la carte.</p></article>
		
				<div id="control_mode">
					<button class="btn_mode" id="btn_2d" type="button">2d</button>
					<button class="btn_mode" id="btn_3d" type="button">3d</button>
					<br/>
					<button class="btn_mode" id="btn_in" type="button">zoom +</button>
					<br/>
					<button class="btn_mode" id="btn_out" type="button">zoom -</button>
					<br/>
					<button class="btn_mode" id="btn_reset" type="button">reset</button>
					<br/>
					<div id="btn_rotation">
						<input id="rotationX" type="range" min="-180" max="180" step="1" value="0" /> Rotation X
						<br/>
						<input id="rotationY" type="range" min="-180" max="180" step="1" value="0" /> Rotation Y
					</div>
				</div>

				<div id="carte"></div>
				
				<div id="classement">
					<div id="control_annees">
						<div class="fleche"><img src="data/fleches.png" id="btn_precedent" type="button" alt="precedent" /></div>
						<h2 id="current_year">2013</h2>
						<div class="fleche"><img src="data/fleches.png" id="btn_suivant" type="button" alt="suivant" /></div>
					</div>
					<ul id="liste"> </ul>
				</div>


		</section>



		<section id="sources" class="line center">
			<br/>
			<h3>Sources</h3>
			<p>
			</p>
			<p>Data visualisation réalisée par Pierre-Alain Leboucher et Dorian Ratovo</br>
				à l'aide de <a href="http://d3js.org/">D3.js</a> de Mike Bostock, <a href="http://threejs.org/">THREE.js</a> de Mrdoob</p>
			<h3>Changelog</h3>
			<ul>
				<li></li>
				<li></li>
			</ul>
		</section>


		
		<!-- RELIEF -->		
		<script type="x-shader/x-vertex" id="vertexShader">

			#ifdef GL_ES
			precision highp float;
			#endif
				
			uniform sampler2D displacement;
			varying vec2 vUv;
			varying vec3 vNormal;
			
				
			void main() {	

				vec4 newPosition;
				vec4 dv;
				float df;
				dv = texture2D( displacement, uv );
	
				df = 0.30*dv.x + 0.59*dv.y + 0.11*dv.z;
	
				newPosition = vec4( normal * df * 100.0, 0.0) + vec4(position, 1.0);
				
				vUv = uv;
				//vNormal = normal;
				vNormal = normalize(newPosition.xyz);
				
				gl_Position = projectionMatrix * modelViewMatrix * newPosition;
				

			}

		</script>




		<script type="x-shader/x-fragment" id="fragmentShader">

			#ifdef GL_ES
			precision highp float;
			#endif

			
			uniform sampler2D displacement;
			
			varying vec2 vUv;
			varying vec3 vNormal;
			
			

			float random(vec3 scale,float seed){
			    return fract(sin(dot(gl_FragCoord.xyz+seed,scale)) * 43758.5453 + seed);
			}

			float map(float valeur, float minRef, float maxRef, float minDest, float maxDest)
			{
				return minDest + (valeur - minRef) * (maxDest - minDest) / (maxRef - minRef);
			}

			void main(void)
			{
			
				
			    float n = 0.04 * ( .5 - random( vec3( 1. ), length( gl_FragCoord ) ) );
			    float hauteur = texture2D( displacement, vUv ).z;
			    
			    
			    // DIFFUSE
			    vec3 light = vec3(0.5, 0.2, 1.0);
				float diffuse = max(0.0, dot(normalize(vNormal), light));
				//gl_FragColor = vec4(vec3(diffuse), 1.0);
			    
			    
			    
			    
			    // MER
				if( hauteur < 0.001 ){
					gl_FragColor = vec4( (20.0/255.0)+n, (50.0/255.0)+n, (100.0/255.0)+n, 1.0 );
				} else { 			
			
					// 4 COULEURS
					float r, v, b;
					vec3 c1 = vec3(20.0/255.0, 200.0/255.0, 0.0/255.0); 
					vec3 c2 = vec3(200.0/255.0, 200.0/255.0, 20.0/255.0); 
					vec3 c3 = vec3(200.0/255.0, 20.0/255.0, 20.0/255.0);
					vec3 c4 = vec3(0.0/255.0, 40.0/255.0, 80.0/255.0);
					
					if(hauteur < 0.1){
						// c4 -> c3
						r = map(hauteur, 0.0, 0.1, c4.x, c3.x);
						v = map(hauteur, 0.0, 0.1, c4.y, c3.y);
						b = map(hauteur, 0.0, 0.1, c4.z, c3.z);
						
					} else if(hauteur < 0.5){
					
						// c3 -> c2
						r = map(hauteur, 0.1, 0.5, c3.x, c2.x);
						v = map(hauteur, 0.1, 0.5, c3.y, c2.y);
						b = map(hauteur, 0.1, 0.5, c3.z, c2.z);
						
					} else {
						
						// c2 -> c1
						r = map(hauteur, 0.5, 1.0, c2.x, c1.x);
						v = map(hauteur, 0.5, 1.0, c2.y, c1.y);
						b = map(hauteur, 0.5, 1.0, c2.z, c1.z);
					}
			
					vec3 color = vec3(r, v, b);
			    	gl_FragColor = vec4(color+n, 1.0);
				
				}
			 
			}

		</script>


		








			<!-- BACKGROUND -->
			<script type="x-shader/x-vertex" id="background_vertexshader">
		
				#ifdef GL_ES
				precision highp float;
				#endif
				
				void main()
				{
					gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);
				}
		
			</script>

			<script type="x-shader/x-fragment" id="background_fragmentshader">
	
				#ifdef GL_ES
				precision highp float;
				#endif


				float random(vec3 scale,float seed){
			    	return fract(sin(dot(gl_FragCoord.xyz+seed,scale)) * 43758.5453 + seed);
				}
				
				void main()
				{
					// noise
			    	float n = 0.04 * ( .5 - random( vec3( 1. ), length( gl_FragCoord ) ) );

					gl_FragColor = vec4((20.0/255.0)+n, (50.0/255.0)+n, (100.0/255.0)+n, 1.0);
				}
			
			</script>


		<script type="text/javascript" src="http://rsf.org/squelettes/lib/js/jquery-1.4.2.min.js"></script>
		<script type="text/javascript" src="js/d3.js"></script>
		<script type="text/javascript" src="js/three.js"></script>
		<script type="text/javascript" src="js/queue.js"></script>
		<script type="text/javascript" src="js/utils.js"></script>
		<script type="text/javascript" src="js/blur.js"></script>
		<script type="text/javascript" src="js/main.js"></script>
		<script type="text/javascript" src="js/less-1.6.2.min.js" ></script>
		


	</body>
</html>
